
# This HaProxy configuration is generated by consul-templaterb
# Service/Instances filtering
# Service tag MUST be http
# Instance tag MUST be http
# Instance tag excluded: canary

# Found 1 different services with 4 nodes

global
  maxconn 1024


defaults
  timeout connect 1000
  timeout client 5000
  timeout server 15000

backend backend_http__consul
  mode http
  balance leastconn
  server consul01.prod_8300 5.6.7.8:8300 weight 100
  server consul02.prod_8300 10.251.1.96:8300 weight 12
  server consul03.prod_8300 10.251.1.97:8300 weight 100
  server consul04.prod_8300 10.251.1.99:8300 disabled weight 100

frontend fontend_http
   mode http
   bind *:8000
   option httplog
   log 127.0.0.1:534 local5
   option  dontlognull
   option forwardfor

   acl host__consul hdr_beg(host) -i consul.
   use_backend backend_http__consul if host__consul


listen stats
  bind    :8001
  mode            http
  log             global
  maxconn 10
  timeout client  100s
  timeout server  100s
  timeout connect 100s
  timeout queue   100s
  stats enable
  stats hide-version
  stats refresh 30s
  stats show-node
  stats uri  /haproxy?stats
